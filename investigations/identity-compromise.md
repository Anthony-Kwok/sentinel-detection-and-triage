# Investigation: Potential Identity Compromise

## Objective
Provide a structured, analyst-driven investigation workflow for alerts generated by suspicious sign-in detection. The goal is to validate the risk, determine compromise likelihood, and recommend appropriate response actions.

---

## Alert Summary
A Microsoft Sentinel alert was triggered for abnormal sign-in activity:

- Multiple failed login attempts followed by a successful login within a short time window  
- Sign-ins from an unfamiliar geolocation  
- MFA required but not completed  

This scenario represents a potential credential compromise.

---

## Investigation Steps

### 1. Contextual Validation
- Confirm the userâ€™s role, access level, and normal login patterns  
- Check recent travel or VPN activity  
- Review business activity to rule out legitimate anomalies  

### 2. Azure AD Sign-In Analysis
- Examine timestamp, device, location, and IP address of each login  
- Identify impossible travel scenarios or unusual location patterns  
- Verify MFA completion and compliance with Conditional Access policies  

### 3. Endpoint Correlation
- Check Microsoft Defender for Endpoint telemetry for unusual activity:  
  - New device enrollments  
  - Suspicious process execution  
  - Lateral movement attempts  
- Correlate with sign-in data to confirm or refute compromise  

### 4. Risk Assessment
- Determine likelihood of compromise based on combined identity and endpoint signals  
- Assign risk score (e.g., low, medium, high) for prioritization  
- Document risk justification for escalation or closure  

### 5. Documentation & Ticketing
- Record alert details, investigation steps, and findings in ServiceNow  
- Include contextual notes, screenshots, or KQL queries used  
- Flag for follow-up if repeat or related activity is detected  

---

## Findings
- Sign-ins originated from an unusual IP and geolocation  
- MFA was bypassed or not completed as required  
- Endpoint telemetry showed no suspicious activity  

**Assessment:** Potential credential compromise, no active endpoint compromise detected

---

## Recommended Response
- Force immediate password reset for the affected account  
- Enforce MFA and review Conditional Access policies  
- Monitor subsequent login attempts and endpoints for recurring anomalies  
- Notify user and provide awareness guidance if applicable  

---

## Lessons Learned
- Identity-based alerts may not correlate with endpoint anomalies  
- Structured analyst workflows improve response speed and accuracy  
- Contextual validation is critical to reduce false positives and unnecessary escalations  

---

## Next Steps / Improvements
- Integrate UEBA and risk-based scoring for enhanced anomaly detection  
- Automate enrichment with endpoint and threat intelligence data  
- Refine alert thresholds based on historical login behavior  

---

## Notes
- Investigation uses simulated data and sanitized examples  
- Illustrates end-to-end SOC analyst workflow suitable for consulting portfolio  
- Demonstrates alignment between detection, investigation, and business-aligned response
